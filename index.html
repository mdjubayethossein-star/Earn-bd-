<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earn bd</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src='//libtl.com/sdk.js' data-zone='9465942' data-sdk='show_9465942'></script>

    <style>
        :root { --main: #ff007f; --white: #ffffff; --bg: #fff0f5; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: linear-gradient(180deg, #ff007f 0%, #ff69b4 100%); color: #333; min-height: 100vh; overflow-x: hidden; }
        
        .header { padding: 25px 20px; display: flex; justify-content: space-between; align-items: center; color: white; }
        .u-info { display: flex; align-items: center; gap: 12px; }
        .avatar { width: 50px; height: 50px; border-radius: 50%; border: 2px solid #fff; object-fit: cover; }
        .wallet-box { background: rgba(0,0,0,0.25); padding: 7px 15px; border-radius: 20px; font-weight: bold; }

        /* ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡ßã‡¶≤‡¶ø‡¶Ç ‡¶®‡ßã‡¶ü‡¶ø‡¶∂‡ßá‡¶∞ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        .banner-box { padding: 0 15px; margin-bottom: 15px; }
        .theme-banner { width: 100%; height: 140px; border-radius: 15px; object-fit: cover; box-shadow: 0 5px 15px rgba(0,0,0,0.2); border: 2px solid rgba(255,255,255,0.3); }
        .marquee-container { background: white; border-radius: 10px; padding: 8px 12px; margin-top: 10px; display: flex; align-items: center; gap: 10px; color: var(--main); box-shadow: 0 3px 10px rgba(0,0,0,0.1); }
        .marquee-text { font-weight: bold; font-size: 13px; }

        .container { background: var(--white); border-radius: 35px 35px 0 0; padding: 25px 20px; min-height: 85vh; box-shadow: 0 -10px 20px rgba(0,0,0,0.1); }
        .brand-box { text-align: center; margin-bottom: 20px; }
        .brand-text { font-weight: 900; color: var(--main); font-size: 1.6rem; letter-spacing: 1px; text-transform: uppercase; margin: 0; }
        .brand-sub { font-size: 12px; color: #888; display: block; }
        
        .menu-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .menu-item { background: white; border-radius: 20px; padding: 20px 5px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.06); cursor: pointer; transition: 0.2s; }
        .menu-item:active { transform: scale(0.9); }
        .icon-box { width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; color: white; font-size: 20px; }

        .screen { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 1000; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        .active-page { display: block; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .back-btn { font-size: 24px; color: var(--main); cursor: pointer; margin-bottom: 20px; display: inline-block; }
        .btn-action { width: 100%; padding: 15px; border-radius: 15px; border: none; background: var(--main); color: white; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .card { background: var(--bg); padding: 20px; border-radius: 20px; margin-bottom: 15px; border: 1px solid #ffdeef; }
        .list-row { display: flex; justify-content: space-between; padding: 12px; background: #f9f9f9; border-radius: 12px; margin-bottom: 8px; }
        
        input, select { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; margin-top: 5px; box-sizing: border-box; }
        .top-user-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>

    <div id="home-page">
        <div class="header">
            <div class="u-info">
                <img src="" id="home-avatar" class="avatar">
                <div><b id="home-name">User</b><br><small id="home-tag">@username</small></div>
            </div>
            <div class="wallet-box">‡ß≥ <span id="main-balance">0.00</span></div>
        </div>

        <div class="banner-box">
            <img id="top-banner" class="theme-banner" src="https://images.unsplash.com/photo-1621360841013-c76831f1db71?q=80&w=600&auto=format&fit=crop" alt="Theme Banner">
            <div class="marquee-container">
                <i class="fas fa-bullhorn"></i>
                <marquee id="scroll-text" class="marquee-text" behavior="scroll" direction="left" scrollamount="5">Earn BD ‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ! ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¨‡ßá‡¶∂‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶®‡¶ø‡¶®...</marquee>
            </div>
        </div>

        <div class="container">
            <div class="brand-box">
                <h1 class="brand-text" id="bot-title">Earn bd <i class="fas fa-check-circle" style="font-size: 18px;"></i></h1>
                <span class="brand-sub">The Best Earning Platform 2026</span>
            </div>

            <div class="menu-grid">
                <div class="menu-item" onclick="nav('monetag-task')"><div class="icon-box" style="background:#7b2ff7;"><i class="fas fa-play"></i></div><small>Start Task</small></div>
                <div class="menu-item" onclick="nav('tg-task')"><div class="icon-box" style="background:#0088cc;"><i class="fab fa-telegram-plane"></i></div><small>TG Task</small></div>
                <div class="menu-item" onclick="nav('profile-sc')"><div class="icon-box" style="background:#ff4081;"><i class="fas fa-user"></i></div><small>Profile</small></div>
                <div class="menu-item" onclick="nav('top-sc')"><div class="icon-box" style="background:#ff9800;"><i class="fas fa-crown"></i></div><small>Top Users</small></div>
                <div class="menu-item" onclick="nav('withdraw-sc')"><div class="icon-box" style="background:#00c853;"><i class="fas fa-wallet"></i></div><small>Withdraw</small></div>
                <div class="menu-item" onclick="nav('history-sc')"><div class="icon-box" style="background:#2196f3;"><i class="fas fa-history"></i></div><small>History</small></div>
                <div class="menu-item" onclick="nav('notice-sc')"><div class="icon-box" style="background:#f44336;"><i class="fas fa-bell"></i></div><small>Notice</small></div>
                <div class="menu-item" onclick="nav('inbox-sc')"><div class="icon-box" style="background:#333;"><i class="fas fa-envelope-open-text"></i></div><small>Inbox</small></div>
                <div class="menu-item" onclick="openSupport()"><div class="icon-box" style="background:#9c27b0;"><i class="fas fa-headset"></i></div><small>Support</small></div>
            </div>
        </div>
    </div>

    <div id="monetag-task" class="screen">
        <i class="fas fa-arrow-left back-btn" onclick="back()"></i>
        <h3 style="text-align:center;">Daily Ad Task</h3>
        <div class="card" style="text-align:center;">
            <p id="reward-text" style="font-size:18px; font-weight:bold; color:var(--main);">Earn: ‡ß≥ ‡ß¶.‡ß¶‡ß≠</p>
            <p id="ad-stat">Daily: 0 / 100</p>
            <p id="hourly-stat" style="font-size: 12px; color: #666;">Hourly: 0 / 50</p>
            <div style="background:#eee; height:12px; border-radius:10px; margin:15px 0; overflow:hidden;">
                <div id="ad-progress-bar" style="background:var(--main); height:100%; width:0%; transition:0.3s;"></div>
            </div>
            <button class="btn-action" id="watch-ad-btn" onclick="runAd()">WATCH AD</button>
        </div>
    </div>

    <div id="inbox-sc" class="screen"><i class="fas fa-arrow-left back-btn" onclick="back()"></i><h3>üì© Inbox Alerts</h3><div id="notif-list"></div></div>
    <div id="tg-task" class="screen"><i class="fas fa-arrow-left back-btn" onclick="back()"></i><h3>Special Tasks</h3><div id="tg-task-list"></div></div>
    <div id="profile-sc" class="screen"><i class="fas fa-arrow-left back-btn" onclick="back()"></i><div style="text-align:center;"><img id="prof-img" src="" style="width:100px; height:100px; border-radius:50%; border:3px solid var(--main);"><h2 id="prof-name">User</h2><div class="card"><div class="list-row"><span>Balance:</span> ‡ß≥ <span class="val-bal">0.00</span></div><div class="list-row"><span>Total Tasks:</span> <b id="prof-task-done">0</b></div><div class="list-row"><span>User ID:</span> <b id="prof-id">0</b></div></div><button class="btn-action" onclick="nav('refer-sc')">My Referral Link</button></div></div>
    <div id="withdraw-sc" class="screen"><i class="fas fa-arrow-left back-btn" onclick="back()"></i><div class="card" style="background:var(--main); color:white; text-align:center;"><p>Current Balance</p><h1>‡ß≥ <span class="val-bal">0.00</span></h1></div><select id="w-method"><option value="Bkash">Bkash</option><option value="Nagad">Nagad</option></select><input type="number" id="w-amt" placeholder="Enter amount (Min 50)"><input type="text" id="w-num" placeholder="Enter Number"><button class="btn-action" onclick="doWithdraw()">WITHDRAW NOW</button></div>
    <div id="top-sc" class="screen"><i class="fas fa-arrow-left back-btn" onclick="back()"></i><h3 style="text-align:center;">Top Users</h3><div id="leaderboard"></div></div>
    <div id="notice-sc" class="screen"><i class="fas fa-arrow-left back-btn" onclick="back()"></i><h3>Notice</h3><div class="card" id="admin-notice">üì¢ Loading notice...</div></div>
    <div id="history-sc" class="screen"><i class="fas fa-arrow-left back-btn" onclick="back()"></i><h3>History</h3><div id="history-list"></div></div>
    <div id="refer-sc" class="screen"><i class="fas fa-arrow-left back-btn" onclick="back()"></i><h3>Refer</h3><div class="card" id="ref-link-box"></div></div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAAC0VHMLLTtwPZ4LGpEMCYnaM7NbAgnY0",
            databaseURL: "https://earn-bd-793b3-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const tg = window.Telegram.WebApp;
        tg.expand();

        let balance = 0.00;
        let adCount = 0;
        let hourlyCount = 0;
        let userId = "guest";
        
        let remoteConfig = { status: 'on', reward: 0.07, limit: 100, hourlyLimit: 50 };
        let vpnConfig = { status: 'off', countryCode: 'CA', countryName: 'Canada' };
        let adStrategy = { doubleAd: false, delaySeconds: 0 };
        let supportLink = 'https://t.me/earnkingadmin'; // ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü

        // ‡ßß. ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï (Notice, Bot Name, Ad Settings, VPN, CPM, Banner)
        db.ref('admin_settings').on('value', (snap) => {
            if(snap.exists()) {
                const data = snap.val();
                
                // ‡¶™‡ßÅ‡¶∞‡¶æ‡¶®‡ßã monetag ‡¶¨‡¶æ ‡¶®‡¶§‡ßÅ‡¶® tasks ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶ï‡¶∞‡¶æ
                if(data.tasks) {
                    remoteConfig.reward = parseFloat(data.tasks.adReward) || remoteConfig.reward;
                    remoteConfig.limit = parseInt(data.tasks.dailyLimit) || remoteConfig.limit;
                    remoteConfig.hourlyLimit = parseInt(data.tasks.hourlyLimit) || remoteConfig.hourlyLimit;
                    document.getElementById('reward-text').innerText = `Earn: ‡ß≥ ${remoteConfig.reward}`;
                } else if(data.monetag) {
                    remoteConfig = data.monetag;
                    document.getElementById('reward-text').innerText = `Earn: ‡ß≥ ${remoteConfig.reward}`;
                }

                if(data.vpn) vpnConfig = data.vpn;
                if(data.ad_strategy) adStrategy = data.ad_strategy;
                if(data.links && data.links.support) supportLink = data.links.support;

                // ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü (‡¶¨‡ßú ‡¶™‡ßá‡¶ú ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡ßã‡¶≤‡¶ø‡¶Ç ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¶‡ßÅ‡¶á ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ‡¶§‡ßá‡¶á)
                if(data.notice) {
                    document.getElementById('admin-notice').innerText = data.notice;
                    document.getElementById('scroll-text').innerText = data.notice;
                }
                
                // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶ú ‡¶Ü‡¶™‡¶°‡ßá‡¶ü (‡¶Ø‡¶¶‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá theme/banner ‡¶•‡¶æ‡¶ï‡ßá)
                if(data.theme && data.theme.banner) {
                    document.getElementById('top-banner').src = data.theme.banner;
                }

                if(data.bot && data.bot.name) {
                    document.getElementById('bot-title').innerHTML = data.bot.name + ' <i class="fas fa-check-circle" style="font-size: 18px;"></i>';
                }
                
                // ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶Æ‡ßá‡¶•‡¶° ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
                if(data.methods) {
                    let mHtml = "";
                    Object.values(data.methods).forEach(m => {
                        mHtml += `<option value="${m.name}">${m.name} (Min ‡ß≥${m.min})</option>`;
                    });
                    document.getElementById('w-method').innerHTML = mHtml;
                }

                updateUI();
            }
        });

        // ‡ß®. ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶¨‡¶æ‡¶ü‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        function openSupport() {
            window.open(supportLink);
        }

        // ‡ß©. ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶á‡¶®‡¶¨‡¶ï‡ßç‡¶∏ ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶≤‡ßã‡¶°
        if(tg.initDataUnsafe.user) {
            const u = tg.initDataUnsafe.user;
            userId = u.id;
            document.getElementById('home-name').innerText = u.first_name;
            document.getElementById('prof-name').innerText = u.first_name;
            document.getElementById('prof-id').innerText = u.id;
            document.getElementById('home-tag').innerText = "@" + (u.username || "user");
            const pic = u.photo_url || "https://ui-avatars.com/api/?background=ff007f&color=fff&name=" + u.first_name;
            document.getElementById('home-avatar').src = pic;
            document.getElementById('prof-img').src = pic;
            document.getElementById('ref-link-box').innerText = `https://t.me/earnbd75_bot?start=${u.id}`;

            db.ref('users/' + userId).on('value', (snap) => {
                if(snap.exists()){
                    const data = snap.val();
                    balance = parseFloat(data.balance) || 0;
                    adCount = parseInt(data.adCount) || 0;
                    hourlyCount = parseInt(data.hourlyCount) || 0;
                    document.getElementById('prof-task-done').innerText = data.totalAds || adCount;
                    updateUI();
                } else {
                    db.ref('users/' + userId).set({ name: u.first_name, balance: 0, adCount: 0, hourlyCount: 0, totalAds: 0, totalClicks: 0 });
                }
            });

            // ‡¶á‡¶®‡¶¨‡¶ï‡ßç‡¶∏ ‡¶®‡ßã‡¶ü‡¶ø‡¶∂
            db.ref('notifications/' + userId).on('value', snap => {
                let html = "";
                snap.forEach(c => {
                    const n = c.val();
                    html += `<div class="card" style="border-left: 5px solid var(--main);">
                        <b>${n.title}</b><br><small>${n.time || ''}</small>
                        <p>${n.message}</p>
                    </div>`;
                });
                document.getElementById('notif-list').innerHTML = html || "‡¶ï‡ßã‡¶® ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶®‡ßá‡¶á‡•§";
            });
        }

        // ‡ß™. ‡¶ü‡¶™ ‡¶Æ‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø 
        db.ref('users').orderByChild('balance').limitToLast(10).on('value', snap => {
            let html = ""; let arr = [];
            snap.forEach(c => arr.push(c.val()));
            arr.reverse().forEach((u, i) => {
                html += `<div class="top-user-item"><span>${i+1}. ${u.name}</span> <b>‡ß≥ ${u.balance.toFixed(2)}</b></div>`;
            });
            document.getElementById('leaderboard').innerHTML = html;
        });

        db.ref('withdrawals').on('value', snap => {
            let html = "";
            snap.forEach(c => {
                const w = c.val();
                if(w.uid == userId) {
                    html += `<div class="list-row"><span>${w.method} - ‡ß≥${w.amount}</span><b style="color:${w.status == 'pending' ? 'orange' : 'green'}">${w.status}</b></div>`;
                }
            });
            document.getElementById('history-list').innerHTML = html || "No history";
        });

        // ‡ß´. ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶ï‡¶æ‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶ö‡ßá‡¶ï, ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü, ‡¶°‡¶æ‡¶¨‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶è‡¶¨‡¶Ç ‡¶°‡¶ø‡¶≤‡ßá (CPM Optimization)
        async function runAd() {
            // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü (‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
            db.ref('users/' + userId).child('totalClicks').set(firebase.database.ServerValue.increment(1));

            if(vpnConfig.status === 'on') {
                try {
                    const res = await fetch('https://ipapi.co/json/');
                    const ip = await res.json();
                    
                    // ‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶ï‡¶æ‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤‡ßá ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ
                    db.ref('users/' + userId).update({ lastCountry: ip.country_name || vpnConfig.countryName });

                    if(ip.country_code !== vpnConfig.countryCode) {
                        return alert(`‚ö†Ô∏è ‡¶ï‡¶æ‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡¶†‡¶ø‡¶ï ‡¶®‡¶Ø‡¶º!\n\n‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶Ü‡¶á‡¶™‡¶ø: ${ip.country_name}\n‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶•‡ßá‡¶ï‡ßá "${vpnConfig.countryName}" ‡¶ï‡¶æ‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`);
                    }
                } catch(e) { return alert("VPN ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•‡•§ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶¨‡¶æ ‡¶≠‡¶ø‡¶™‡¶ø‡¶è‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§"); }
            }

            if(remoteConfig.status === 'off') return alert("‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶¨‡¶®‡ßç‡¶ß ‡¶Ü‡¶õ‡ßá‡•§");
            if(adCount >= remoteConfig.limit) return alert("‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶∂‡ßá‡¶∑!");
            if(hourlyCount >= remoteConfig.hourlyLimit) return alert("‡¶ò‡¶£‡ßç‡¶ü‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶∂‡ßá‡¶∑! ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶™‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
            
            // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶™‡ßç‡¶∞‡¶Æ‡¶ø‡¶∏ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
            const showMyAd = () => {
                return new Promise((resolve) => {
                    if (typeof show_9465942 === 'function') {
                        show_9465942().then(resolve).catch(resolve);
                    } else { resolve(); }
                });
            };

            const btn = document.getElementById('watch-ad-btn');
            btn.innerText = "‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
            btn.disabled = true;

            try {
                // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°
                await showMyAd();

                // ‡¶°‡¶æ‡¶¨‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶ö‡ßá‡¶ï
                if(adStrategy.doubleAd === true) {
                    await new Promise(r => setTimeout(r, 1000)); // ‡ßß ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶¨‡¶ø‡¶∞‡¶§‡¶ø
                    await showMyAd();
                }

                // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶°‡¶ø‡¶≤‡ßá (‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü)
                if(adStrategy.delaySeconds > 0) {
                    document.getElementById('reward-text').innerText = `‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá ${adStrategy.delaySeconds} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...`;
                    await new Promise(r => setTimeout(r, adStrategy.delaySeconds * 1000));
                }

                completeAd();
            } catch(e) {
                completeAd(); // ‡¶è‡¶∞‡¶∞ ‡¶π‡¶≤‡ßá‡¶ì ‡¶∞‡¶ø‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶¨‡ßá ‡¶Ø‡¶æ‡¶§‡ßá ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶∞‡¶ï‡ßç‡¶§ ‡¶®‡¶æ ‡¶π‡ßü
            } finally {
                btn.innerText = "WATCH AD";
                btn.disabled = false;
            }
        }

        function completeAd() {
            const rewardAmount = parseFloat(remoteConfig.reward) || 0;
            db.ref('users/' + userId).update({ 
                balance: balance + rewardAmount, 
                adCount: adCount + 1,
                hourlyCount: hourlyCount + 1,
                totalAds: firebase.database.ServerValue.increment(1)
            });
            document.getElementById('reward-text').innerText = `Earn: ‡ß≥ ${remoteConfig.reward}`;
            tg.showPopup({message: "‡ß≥" + remoteConfig.reward + " ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏‡ßá ‡¶Ø‡ßã‡¶ó ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!"});
        }

        // ‡ß¨. TG Task ‡¶ì ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞
        db.ref('admin_settings/tg_tasks').on('value', (snap) => {
            let html = "";
            snap.forEach(child => {
                const task = child.val();
                html += `<div class="card"><b>${task.title} (‡ß≥ ${task.reward})</b><br>
                    <button class="btn-action" style="background:#0088cc;" 